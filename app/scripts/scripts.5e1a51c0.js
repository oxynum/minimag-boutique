"use strict";angular.module("minimagApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","NgSwitchery","angularMoment","ngDialog","ngCordova","angular-loading-bar","ng-token-auth","restangular"]).config(["$routeProvider","$authProvider","config","RestangularProvider",function(a,b,c,d){a.when("/",{templateUrl:"views/sales.html",controller:"SalesCtrl",controllerAs:"sales"}).when("/cashier",{templateUrl:"views/cashier-shift.html",controller:"CashiersCtrl",controllerAs:"cashier"}).when("/archives",{templateUrl:"views/tickets-archives.html",controller:"TicketsArchivesCtrl",controllerAs:"archives"}).when("/closedcashiers",{templateUrl:"views/closed-cashiers.html",controller:"ClosedcashiersCtrl",controllerAs:"clsCashiers"}).when("/settings",{templateUrl:"views/settings.html",controller:"SettingsCtrl",controllerAs:"set"}).when("/pendings",{templateUrl:"views/pendings.html",controller:"PendingsCtrl",controllerAs:"pendings"}).when("/prestashop",{templateUrl:"views/prestashop.html",controller:"PrestashopCtrl",controllerAs:"pr"}).otherwise({redirectTo:"/"}),d.setBaseUrl(c.apiPrestashop.urlApi),b.configure({apiUrl:c.apiPrestashop.urlApi,validateOnPageLoad:!1})}]).run(["$auth","config",function(a,b){FastClick.attach(document.body),a.submitLogin({email:"thomas@oxynum.fr",password:"qwertyuiop"})}]),function(){var a=function(a,b,c,d,e,f,g,h,i,j,k,l,m){j.checkOpenShift();var n=this;d.active=0,n.clientOptions={print:!0,mail:!1},localforage.getItem("grid").then(function(a){1==a?n.isGrid=!0:n.isGrid=!1});var o=function(){g.schemaOfTicket.client={},g.schemaOfTicket.client.id=moment().unix().toString()},p=function(){g.itemsTicket=[],g.schemaOfTicket={},g.listVAT=[],n.ticketAmount=g.schemaOfTicket.ticketAmount,n.ticket=g.schemaOfTicket,o()},q=function(){n.displayPayment=!1,n.printable=!0},r=function(){h.init("yes"),n.displayPayment=!1,n.ticket=g.schemaOfTicket,n.search="",n.moneyLeft=0,n.moneyGiven=0,n.input=[],n.card={},n.card.amount=0,n.cash={},n.cash.amount=0,n.cheque={},n.cheque.amount=0,n.giftCard={},n.giftCard.amount=0,n.others={},n.others.amount=0};n.displayDefaultPicture=function(b){var c=e.defer(),d=b,f=null;return a.getPicture(d).then(function(a){var b=new DOMParser,d=b.parseFromString(a.data,"text/xml");f=d.getElementsByTagName("declination")[0].attributes.item(0).nodeValue,c.resolve(f)},function(a){c.reject(a)}),c.promise},r(),o();var s=function(){f.save("items",n.items),f.save("lastSync",{date:moment().format("YYYY-MM-DD HH:mm")})},t=function(a){var b=a.data.prestashop.products.product;n.items=_.forEach(b,function(a){a.priceTTC=g.getPriceTTC(a.price,a.id_tax_rules_group),a.rate=g.getTax(a.id_tax_rules_group),a.vat=g.VAT(a.price,a.id_tax_rules_group).toFixed(2)}),l(function(){s()},2e3)},u=function(a){console.log("YOLO :",a)};n.toggleGrid=function(){n.isGrid?(n.isGrid=!1,localforage.setItem("grid",!1)):(n.isGrid=!0,localforage.setItem("grid",!0))},n["return"]=function(){r()},n.isTicket=function(){return g.itemsTicket.length<1?!0:!1},n.getItems=function(a){g.addItemToTicket(a),n.getTotal(),h.init("yes")},n.flashItems=function(a,b){var c=_.filter(a,["ean13",b]);return c.length>1?(alert("Warning Duplicate key \n Please select an item"),h.init("yes"),!1):0===c.length?(g.productNotFound(),n.search="",!1):(g.addItemToTicket(c[0]),n.getTotal(),n.search="",void h.init("yes"))},n.getTotal=function(a){n.ticketAmount=g.schemaOfTicket.ticketAmount},n.initBalance=function(){n.due=n.ticket.ticketAmount,n.input=[],n.moneyGiven=0,n.moneyLeft=0},n.validateTicket=function(){n.initBalance(),n.displayPayment=!0},n.sum=function(a,d){if(0===a){var e=confirm("Total amount !");if(e!==!0)return;a=parseFloat(n.due)}switch(d){case"cb":n.card={},n.card.value=!0,n.card.amount=a;break;case"esp":n.cash={},n.cash.value=!0,n.cash.amount=a,j.updateCashInCashier(a);break;case"chq":n.cheque={},n.cheque.value=!0,n.cheque.amount=a;break;case"gift":n.giftCard={},n.giftCard.value=!0,n.giftCard.amount=a;break;case"pp":n.others={},n.others.value=!0,n.others.amount=a}var f=n.card.amount+n.cash.amount+n.cheque.amount+n.giftCard.amount+n.others.amount;n.due=n.ticket.ticketAmount-f,n.input=[],n.moneyGiven=0,n.moneyLeft=0,g.schemaOfTicket.isPaidBy={card:{value:n.card.value?!0:!1,amount:n.card.amount?n.card.amount:0},cash:{value:n.cash.value?!0:!1,amount:n.cash.amount?n.cash.amount:0,moneyBack:Math.abs(n.due)},cheque:{value:n.cheque.value?!0:!1,amount:n.cheque.amount?n.cheque.amount:0},giftCard:{value:n.giftCard.value?!0:!1,amount:n.giftCard.amount?n.giftCard.amount:0},paypal:{value:n.others.value?!0:!1,amount:n.others.amount?n.others.amount:0}},0===_.round(n.due,2)?(g.schemaOfTicket.shopInfo=k.shopInfo,g.save(g.schemaOfTicket,function(a){n.sendTicketToClient(a),q()})):parseFloat(n.due)<0&&(c.openConfirm({template:'<div class="modalus"><div class="content-modalus">Currency money :'+b("currency")(-1*n.due,"â‚¬")+'</div><button class="confirm-madalus" ng-click="confirm()">Given</button></div>',plain:!0}),g.schemaOfTicket.shopInfo=k.shopInfo,g.save(g.schemaOfTicket,function(a){n.sendTicketToClient(a),q()}))},n.balanceCalculator=function(a,b){return b.length?("x"===b?n.input=[]:n.input.push(b),n.moneyGiven=_.parseInt(_.join(n.input,""))/100,void(n.due||(n.due=n.ticketAmount-n.moneyGiven))):void n.initBalance()};n.sendTicketToClient=function(a){n.clientOptions.print&&g.print(a,function(a,b){b?(console.error(b),alert("Problem came, ticket can not be printed.")):(console.log("Ticket Printed"),r())}),n.clientOptions.mail&&""!=n.inputMail?g.sendTicketByMail(a,n.inputMail,function(a,b){b?(console.error(b),alert("Problem came, ticket can not be sent by mail.")):(console.log("Mail sent to: "+mail),alert("Ticket Sent by mail to: "+n.input))}):n.clientOptions.mail&&""==n.inputMail&&alert("Ticket can not be sent by mail; no mail provided.")},n.updateClientOptions=function(a){switch(a){case"mail":0==n.clientOptions.mail&&(n.inputMail=""),n.clientOptions.mail=n.clientOptions.mail?!1:!0;break;case"print":n.clientOptions.print=n.clientOptions.print?!1:!0;break;default:console.warn("Not good value provided")}},n.displayItems=function(){m.isOnline()?(a.getAllArticles().then(t,u),console.log("success login")):f.load("items").then(function(b){b?n.items=b:a.getAllArticles().then(t,u)})},n.displayItems(),d.$on("new_customers",function(){console.log("aller nouveau client"),r(),o(),p(),n.printable=!1}),d.$on("keyListner",n.balanceCalculator),d.$on("ticket_addSameItemToTicket",function(){n.ticketAmount=g.schemaOfTicket.ticketAmount}),d.$on("ticket_deleteItemLine",function(){n.getTotal()}),d.$on("ticket_removeItemInTicket",function(){n.getTotal()}),d.$on("ticket_validateTicket",function(){n.validateTicket(n)}),n.isTicket?n.getTotal():null};angular.module("minimagApp").controller("SalesCtrl",["wpApi","$filter","ngDialog","$rootScope","$q","synchronization","transaction","focus","$location","cashier","config","$timeout","connection",a])}(),angular.module("minimagApp").constant("config",{cashier:{name:"Caisse-1"},format:"output_format=JSON",display:"&display=full",url:"http://demo.minimag.shop",url_minimag:"http://188.166.35.80/prestashops",urlImage:"http://demo.minimag.shop/img",admin:"/admin416r6jj4p",username:"ZXGQXNY4P1X525KPI38UZKLA379BDB65",publickey:"ZXGQXNY4P1X525KPI38UZKLA379BDB65",format:"output_format=JSON",display:"&display=full",apiPrestashop:{email:"thomas@oxynum.fr",password:"qwertyuiop",urlApi:"http://188.166.35.80",id:1,routes:{transactions:"/api/transactions",cashiers:"/api/cashiers"}},shopInfo:{name:"Minimag store",address:"33 avenue victor hugo",postalCode:511,city:"Paris",country:"FR",tel:"+336.61027526",websiteUrl:"http://demo.minimag.shop/api"},printer:{type:"NETWORK",ip:"192.168.1.201",port:"6001"},mailApi:{apiKey:"c81326c751c0743883c3d76fa882d8c0",apiSecret:"b478a74a16d1437962a1f3d370e2afdc"},minihub:{ip:"127.0.0.1",port:"3001"},messageOptions:{promo:"-50% sur tout le magasin du 17 au 20 avril 2017",thanks:"Merci de votre visite et a bientot",info:"Conserver votre ticket afin de beneficier de code reduction"}}),function(){function a(a,b,c,d,e){var f=this;f.baseUrl=b.url,f.baseUrlImage=b.urlImage,delete c.defaults.headers.common.Authorization;var g=function(a){var b=[];return a.ticketData.forEach(function(a){var c={id_product:a.id,quantity:a.cartQuantity};b.push(c)},this),b};f.getAllArticles=function(){return c({method:"GET",url:b.url_minimag+"/1/products"})},f.getTaxes=function(){return c({method:"GET",url:b.url_minimag+"/1/taxes"})},f.syncTransaction=function(c){var d=a.defer(),f={order:{rows:g(c),total_paid:c.ticketAmount,total_paid_real:c.ticketAmount,total_products:c.ticketAmount,total_products_wt:c.ticketAmount-c.totalVAT}};return e.one("prestashops",b.apiPrestashop.id).post("orders",f).then(function(a){console.log("%cTicket Synchronized, order created in Prestashop","color: #669900;"),d.resolve(c)},function(a){alert("Impossible to add order in Prestashop. Unauthorized by the server."),d.reject(a)}),d.promise}}angular.module("minimagApp").service("wpApi",["$q","config","$http","synchronization","Restangular",a])}(),angular.module("minimagApp").controller("TicketsArchivesCtrl",["transaction","$rootScope","synchronization","wpApi","$location","cashier","print","ticketFactory","ngDialog","$scope",function(a,b,c,d,e,f,g,h,i,j){f.checkOpenShift();var k=this;b.active=1,k.hideTicket=!0,k.currentTicket={},k.displayTicket=!1,k.isCurrentTicketActive=!0,(k.getTickets=function(b){switch(k.currentTicket=void 0,k.hideTicket=!0,b){case"archives":k.isCurrentTicketActive=!1,l();break;default:k.isCurrentTicketActive=!0,a.getAll().then(function(a){k.ticketsList=a,console.log(a)})}})(),k.canceledItem=function(b){if(!k.isCurrentTicketActive)return void alert("Canceling tickets impossible on Archives Tickets.");if(confirm("Are you sure to cancel the \n Ticket with ID: \n"+b)){var c=_.find(k.ticketsList,{ticketId:b});c.status="CANCELED",a.saveAll(k.ticketsList),console.log(k.ticketsList)}},b.$on("ticket_sync",function(b,c){if(k.currentTicket.hasBeenSynchronized===!0)return void alert("Ticket already synchronized");if(confirm("Are you sure to syncronized the \n Ticket with ID: \n"+c)){var d=_.find(k.ticketsList,{ticketId:c});d.hasBeenSynchronized=!0,a.saveAll(k.ticketsList),console.log(k.ticketsList)}}),k.openTicket=function(a){k.displayTicket=!0,k.hideTicket=!1,k.currentTicket=_.find(k.ticketsList,{ticketId:a}),k.printable=!0};var l=function(){c.load("closedCashiers").then(function(a){return a?(k.closedCashiers=a,k.ticketsList=[],void a.data.forEach(function(a){k.ticketsList=k.ticketsList.concat(a.data),console.log(a)},this)):void(k.ticketsList=[])})};b.$on("ticket_printDuplicate",function(b){var c={};if(k.currentTicket.hasBeenPrint){c=_.find(k.ticketsList,{ticketId:b.targetScope.currentTicket.ticketId}),c.type="duplicate",k.isCurrentTicketActive&&a.saveAll(k.ticketsList),console.log("PRINT TICKET",c);var d=new h(c);g.printTicket(d,function(a,b){b?alert("Ticket can not be print."):console.log("Ticket Printed.")})}else{c=_.find(k.ticketsList,{ticketId:b.targetScope.currentTicket.ticketId}),console.log("PRINT TICKET",c);var d=new h(c);g.printTicket(d,function(a,b){b?alert("Ticket can not be print."):console.log("Ticket Printed.")})}}),b.$on("ticket_mailDuplicate",function(b){var c={};if(k.currentTicket.hasBeenSentByMail){c=_.find(k.ticketsList,{ticketId:b.targetScope.currentTicket.ticketId}),c.type="duplicate",k.isCurrentTicketActive&&a.saveAll(k.ticketsList),console.log("MAIL TICKET",c);var d=new h(c);a.sendTicketByMail(d,k.currentTicket.mailReceiver,function(){alert("Ticket Sent by mail to: "+k.currentTicket.mailReceiver)})}else c=_.find(k.ticketsList,{ticketId:b.targetScope.currentTicket.ticketId}),c.type="duplicate",j.dialog={},j.dialog.prompt="Mail receiver: (ex: toto@gmail.com)",j.dialog.type="email",i.openConfirm({template:'<p>{{dialog.prompt}}</p><form class="prompt-dialog-form"><input class="input" type="{{dialog.type}}" ng-model="userAnswer"><button class="confirm" type="submit" ng-click="checkInput(userAnswer)">Ok</button>    </form>',plain:!0,scope:j,controller:["$scope",function(b){b.checkInput=function(d){if(""!=d&&/^[a-zA-Z0-9.!#$%&â€™*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(d)){c.mailReceiver=d,a.saveAll(k.ticketsList),console.log("MAIL TICKET",c);var e=new h(c);e.mailReceiver=c.mailReceiver,a.sendTicketByMail(e,e.mailReceiver,function(a,b){b?alert("Ticket can not be sent by mail. Please provide a valid mail."):alert("Ticket sent by mail to: "+e.mailReceiver)})}b.closeThisDialog()}}]})})}]),angular.module("minimagApp").controller("SettingsCtrl",["$rootScope","synchronization",function(a,b){var c=this;c.config={},a.active=2,c.init=function(){b.load("configType").then(function(d){if(d)switch(c.configIndicator=d,a.configuration=d,d){case"OXYNUM":c.config.shopInfo=b.shopInfo,c.config.username=b.username,c.config.baseurl=b.baseurl,c.config.printer=b.printer,c.config.minihub=b.minihub,c.config.messageOptions=b.messageOptions;break;case"CLIENT":b.load("config").then(function(a){c.config.shopInfo=a.shopInfo,c.config.username=a.username,c.config.baseurl=a.baseurl,c.config.printer=a.printer,c.config.minihub=a.minihub,c.config.messageOptions=a.messageOptions})}else c.configIndicator="OXYNUM",a.configuration="OXYNUM",c.config.shopInfo=b.shopInfo,c.config.username=b.username,c.config.baseurl=b.baseurl,c.config.printer=b.printer,c.config.minihub=b.minihub,c.config.messageOptions=b.messageOptions})},c.refreshProduct=function(){b["delete"]("items").then(function(a){console.log(a),alert("Products has been removed !")})},c.saveConfig=function(){b.save("configType",c.configIndicator),"CLIENT"===c.configIndicator?b.save("config",c.config).then(function(a){a?d(1):null}):d(2)},c.reloadSettings=function(a){switch(a){case"OXYNUM":c.config.shopInfo=b.shopInfo,c.config.username=b.username,c.config.baseurl=b.baseurl,c.config.printer=b.printer,c.config.minihub=b.minihub,c.config.messageOptions=b.messageOptions;break;case"CLIENT":b.load("config").then(function(a){c.config.shopInfo=a.shopInfo,c.config.username=a.username,c.config.baseurl=a.baseurl,c.config.printer=a.printer,c.config.minihub=a.minihub,c.config.messageOptions=a.messageOptions})}};var d=function(a){switch(a){case 1:alert("Saved and Updated selected configuration:\n CLIENT");break;case 2:alert("Can not save changes about OXYNUM cosntant config, just updated selected configuration:\n OXYNUM");break;default:console.log("no code provided")}};c.init()}]),angular.module("minimagApp").controller("PendingsCtrl",["$rootScope","$location","cashier",function(a,b,c){a.active=3}]),angular.module("minimagApp").service("transaction",["synchronization","wpApi","print","ticketFactory","config","mail",function(a,b,c,d,e,f){var g=this,h=[];g.itemsTicket=[],g.schemaOfTicket={},g.listVAT=[],g.config=e;var i=function(a){g.taxes=a.data.prestashop.taxes.tax},j=function(a){console.error(a)},k=function(){for(var a="040",b=0,c=4,d=0;9>d;d++){var e=Math.floor(10*Math.random());a+=e.toString(),a.length%2===0?c+=e:a.length%2!==0&&(b+=e)}var f=3*c+b,g=(10-f%10)%10;return a+=g.toString()};return a.load("taxes").then(function(a){a?g.taxes=a:b.getTaxes().then(i,j)}),g.round=function(a,b){var c=Math.pow(10,b),d=a*c,e=Math.round(d);return e/c},g.getAll=function(){return localforage.getItem("ticket")},g.saveAll=function(a){if(!a)throw new Error("Ticket to Save is Empty");localforage.setItem("ticket",a).then(function(a){console.log("UPDATE TICKET LIST")})},g.save=function(a,c){var e=moment().format("DD/MM/YYYY HH:mm:ss"),f=k();a.client.name="Caisse-1",a.client.id=moment().unix().toString(),a.date=e,a.ticketId=f,a.type="pay",a.hasBeenPrint=!0,localforage.getItem("ticket").then(function(e){function f(b){h=b?b:[],h.push(a),localforage.setItem("ticket",h).then(function(){var b=new d(a);void 0!==c&&c(b),console.log("%c[Transaction & ticketFromTransaction saved] : OK","color: #669900;"),console.log(a,b)})}function g(){a.hasBeenSynchronized=!0,console.log("%c Transaction already synchronized : OK","color: #669900;"),f(e)}function i(){a.hasBeenSynchronized=!1,console.log("%c Transaction synchronized failed : OK","color: red;"),f(e)}b.syncTransaction(a).then(g,i)})},g.getTax=function(a){var b=_.find(g.taxes,["id",a]);return b.rate},g.getPriceTTC=function(a,b){if(b){var c=parseFloat(a)*(1+g.getTax(b)/100);return c.toFixed(2)}},g.VAT=function(a,b){return b?parseFloat(a).toFixed(2)*(g.getTax(b)/100):void 0},g.productNotFound=function(){alert("Product not found !")},g.disctinctVATLine=function(){g.schemaOfTicket.totalVAT=0,g.listVAT=[],_.forEach(g.schemaOfTicket.ticketData,function(a){var b={};b.rate=a.rate,b.vat=g.round(parseFloat(a.vat),2);for(var c=a.cartQuantity-1;c>=0;c--)g.listVAT.push(b)}),g.schemaOfTicket.orderingListVAT=_.groupBy(g.listVAT,"rate"),_.forEach(g.schemaOfTicket.orderingListVAT,function(a,b){g.schemaOfTicket.orderingListVAT[b].total=_.sumBy(a,"vat"),g.schemaOfTicket.totalVAT+=g.schemaOfTicket.orderingListVAT[b].total})},g.updateTicket=function(a){a.cartQuantity=1,g.itemsTicket.push(a),g.schemaOfTicket.client={},g.schemaOfTicket.ticketData=g.itemsTicket,g.schemaOfTicket.ticketAmount=g.getTotalTTC(g.schemaOfTicket.ticketData),g.disctinctVATLine()},g.refreshTicket=function(){g.disctinctVATLine(),g.schemaOfTicket.ticketData=g.itemsTicket,g.schemaOfTicket.ticketAmount=g.getTotalTTC(g.schemaOfTicket.ticketData)},g.verifiedDuplicateItemTicket=function(a,b){_.forEach(a,function(c,d){_.isEqual(b,a[d])&&(a[d].cartQuantity+=1,g.schemaOfTicket.ticketAmount=g.getTotalTTC(g.schemaOfTicket.ticketData),g.disctinctVATLine(),g.hasBeenVerifiedByTicket=!0)})},g.addItemToTicket=function(a){return g.hasBeenVerifiedByTicket=!1,g.verifiedDuplicateItemTicket(g.itemsTicket,a),g.hasBeenVerifiedByTicket?!1:void g.updateTicket(a)},g.getTotalHT=function(a){return _.sumBy(a,function(a){return parseFloat(a.price).toFixed(2)*a.cartQuantity})},g.getTotalTTC=function(a){return _.sumBy(a,function(a){return parseFloat(a.priceTTC).toFixed(2)*a.cartQuantity})},g.print=function(a,b){c.printTicket(a,b)},g.sendTicketByMail=function(a,b,c){f.sendTicketTo(a,b,c)},g}]),angular.module("minimagApp").service("print",["$http","$window","synchronization","config","minihubRoutes","ngDialog","$timeout",function(a,b,c,d,e,f,g){var h=this;h.printTicket=function(a,b){c.load("configType").then(function(e){if(console.log("configtype",e),e)switch(e){case"CLIENT":c.load("config").then(function(c){l(c,a,b)});break;case"OXYNUM":l(d,a,b);break;default:alert("ERROR when Printing")}else k(a,b)})};var i=function(){b.print()};h.printCashier=function(a,b){c.load("configType").then(function(e){if(e)switch(e){case"CLIENT":c.load("config").then(function(c){m(c,a,b)});break;case"OXYNUM":m(d,a,b);break;default:i()}else i()})};var j=function(a,b,c){var d="";switch(c){case"ticket":d=b.cash.value?e.printer.printTicket_openCashDraw:e.printer.printTicket;break;case"cashier":d=e.printer.printCashier;break;default:d=null}return"http://"+a.minihub.ip+":"+a.minihub.port+d},k=function(a){},l=function(b,c,d){c.messageOptions=b.messageOptions,c.shopInfo=b.shopInfo,a({method:"POST",url:j(b,c.isPaidBy,"ticket"),headers:{"content-type":"application/json",ip:b.printer.ip,port:b.printer.port,printer_name:"Printer Test",printer_type:b.printer.type},data:c}).then(function(a){d&&d(a,null)},function(a){d&&d(null,a),console.error(a)})},m=function(b,c,d){console.log(c),c.shopInfo=b.shopInfo,a({method:"POST",url:j(b,null,"cashier"),headers:{"content-type":"application/json",ip:b.printer.ip,port:b.printer.port,printer_name:"Printer Test",printer_type:b.printer.type},data:c}).then(function(a){d&&d(a,null)},function(a){d&&d(null,a),console.error(a)})};return h}]),angular.module("minimagApp").service("synchronization",["config","$http",function(a,b){var c=this;c.save=function(a,b){return localforage.setItem(a,b)},c["delete"]=function(a){return localforage.removeItem(a)},c.load=function(a){return localforage.getItem(a)},c.syncCashier=function(c,d){console.log("SYNC CASHIER",c),b({method:"POST",url:a.apiPrestashop.urlApi+a.apiPrestashop.routes.cashiers,headers:{"content-type":"application/json"},data:c}).then(function(a){d&&d(a,null)},function(a){d&&d(null,a),console.error(a)})},c.syncTickets=function(c,d){b({method:"POST",url:a.apiPrestashop.urlApi+a.apiPrestashop.routes.transactions,headers:{"content-type":"application/json"},data:c}).then(function(a){d&&d(a,null)},function(a){d&&d(null,a),console.error(a)})};var d=function(b){b?(c.baseurl=b.url,c.admin=b.admin,c.username=b.username,c.backoffice=b.url+b.admin,c.print=b.print):(b=a,c.shopInfo=a.shopInfo,c.baseurl=a.url,c.admin=a.admin,c.backoffice=a.url+a.admin,c.username=a.username,c.printer=a.printer,c.messageOptions=a.messageOptions,c.minihub=a.minihub,c.save("param").then(function(){console.log("param is saved")}))};return localforage.getItem("param").then(d),c}]),angular.module("minimagApp").controller("PrestashopCtrl",["$rootScope","synchronization","$sce","config",function(a,b,c,d){var e=this;a.active=4,e.baseurl=c.trustAsResourceUrl(d.url+"/"+d.admin)}]),angular.module("minimagApp").directive("ticket",["ngDialog","transaction","focus","wpApi","$window","config",function(a,b,c,d,e,f){return{templateUrl:"views/partials/ticket.html",restrict:"A",scope:{currentTicket:"=",hideIndicator:"=",enableActions:"=",printable:"="},link:function(g,h,i){g.$watch("printable",function(a){a===!0?(g.enableActions=!1,g.quickPrint=!0):(g.enableActions=!0,g.quickPrint=!1)}),g.$watch("hideIndicator",function(a){g.hideIndicator=a}),g.hideTicket=function(){g.hideIndicator=!0},g.removeAllItemLine=function(a){var c=_.find(b.itemsTicket,["reference",a]);_.remove(b.schemaOfTicket.ticketData,function(a){return a.reference===c.reference}),b.refreshTicket(),g.$emit("ticket_deleteItemLine")},g.config=f,g.applyDiscount=function(a,c,d){var e=d;"percentage"===c&&(e>100&&(e=100),b.schemaOfTicket.ticketData[a].discount=e),"amount"===c&&(b.schemaOfTicket.ticketData[a].discount=e)},g.addItem=function(a){b.addItemToTicket(a),c.init("yes"),b.refreshTicket(),console.log(g.currentTicket),g.$emit("ticket_addSameItemToTicket")},g.removeItem=function(a){a.cartQuantity>1?a.cartQuantity--:null,c.init("yes"),b.refreshTicket(),g.$emit("ticket_removeItemInTicket")},g.openItemInfo=function(b){a.openConfirm({template:'<div class="modalus info-modal"><div class="content-modalus">'+b.name[0].value+"</div><hr><h2> Prix TTC </h2><p>"+b.priceVAT+"</p><hr><h2> Prix HT </h2><p>"+b.price+"</p><hr><h2> RÃ©fÃ©rence </h2><p>"+b.reference+"</p></div>",plain:!0})},g.sendValidateTicket=function(){g.$emit("ticket_validateTicket")};var j=function(){console.log(g.quickPrint,"az"),g.quickPrint===!0&&(e.print(),g.$emit("new_customers"))};g.printTicket=function(a){a.hasBeenPrint||"duplicate"===a.ticketType?(g.$emit("ticket_printDuplicate",a),console.log("duplicate"),j()):j()},g.mailTicket=function(a){(a.hasBeenPrint||"duplicate"===a.ticketType)&&g.$emit("ticket_mailDuplicate",a)},g.syncTicket=function(a){d.syncTransaction(a).then(function(b){console.info(b),a.hasBeenSynchronized&&a.hasBeenSynchronized!==!1||g.$emit("ticket_sync",a.ticketId)},function(a){console.log(a)})}}}}]),angular.module("minimagApp").service("focus",["$rootScope","$timeout",function(a,b){var c=this;return c.init=function(c){b(function(){a.$broadcast("focusOn",c)})},c}]),angular.module("minimagApp").directive("focusOn",function(){return{restrict:"A",link:function(a,b,c){a.$on("focusOn",function(a,d){d===c.focusOn&&b[0].focus()})}}}),angular.module("minimagApp").factory("ticketFactory",["config",function(a){var b=function(b){this.shopInfo={name:a.shopInfo.name,address:a.shopInfo.address,postalCode:a.shopInfo.postalCode,city:a.shopInfo.city,country:a.shopInfo.country,tel:a.shopInfo.phone,websiteUrl:a.url},this.bag=c(b),this.totalTVA=b.totalVAT,this.totalPrice=b.ticketAmount,this.globalDiscountOnTicket=b.globalDiscount,this.clientId=b.client.id,this.ticketId=b.ticketId,this.isPaidBy=b.isPaidBy,this.ticketType=b.type,this.messageOptions=a.messageOptions,this.hasBeenPrint=b.hasBeenPrint||!1,this.hasBeenSentByMail=b.hasBeenSentByMail||!1,this.mailReceiver="",this.hasBeenSynchronized=b.hasBeenSynchronized},c=function(a){var b=[];return a.ticketData.forEach(function(a){var c={name:a.name.constructor===Array?a.name[0].value:a.name,quantity:a.cartQuantity,tvaPrice:a.price,unitPrice:a.priceTTC,productDiscount:a.quantity,productDiscountQuantity:a.quantity_discount,id:a.id};b.push(c)}),b};return b}]),angular.module("minimagApp").service("connection",function(){var a=this;return a.isOnline=function(){return navigator.onLine?!0:!1},a}),angular.module("minimagApp").controller("NavCtrl",["connection","cashier","$timeout","ngDialog","synchronization","$rootScope",function(a,b,c,d,e,f){var g=this;g.isOnline="",g.isShiftOpen=!0,g.isMenuOpen=!0,g.displayConnectionInfo=function(){var a=g.isOnline?"Online":"Offline";e.load("lastSync").then(function(b){return b?void d.openConfirm({template:'<div class="modalus"><div class="content-modalus"> <ul><li><i class="fa fa-wifi"></i> Connection: <b class="info-blue">'+a+'</b></li> <li><i class="fa fa-refresh"></i> Synchronization: <b class="info-blue">'+b.date+"</b></li> </ul></div></div>",plain:!0}):void console.log("error")})},g.toggleMenu=function(){g.isMenuOpen?g.isMenuOpen=!1:g.isMenuOpen=!0},g.checkConnection=function(){a.isOnline()?(g.isOnline=!0,c(g.checkConnection,2e3)):(g.isOnline=!1,c(g.checkConnection,2e3))},(g.init=function(){c(g.checkConnection,2e3),f.closedCashiersLength?g.cashiersUnSync=f.closedCashiersLength:e.load("closedCashiers").then(function(a){a&&(f.closedCashiersLength=a.data.length,g.cashiersUnSync=a.data.length)}),e.load("currentCashier").then(function(a){a?g.name=a.name:g.isShiftOpen=!1})})(),f.$on("closedCashiers_update",function(){e.load("closedCashiers").then(function(a){a&&(f.closedCashiersLength=a.data.length,g.cashiersUnSync=a.data.length)})})}]),angular.module("minimagApp").service("cashier",["synchronization","$rootScope","cashierFactory","$location",function(a,b,c,d){var e=this;return e.isOpen=!1,e.initCashier=function(d,e,f,g){if(""===d||0>e)throw new InvalidArgumentException("Can not save Cashier");var h=new c(d,e,f);h.isOpen=!0,h.createdAt=moment().format("DD/MM/YYYY HH:mm:ss"),a.syncCashier(h,function(c,d){var e=d?h:c.data;d?console.error("Cashier can not be Initiate Sync."):console.log("Cashier init with database",c),a.save("currentCashier",e).then(function(a){b.currentCashier=a,a?g():null,console.log(a)})})},e.addTicket=function(c){a.load("currentCashier").then(function(d){d.data.push(c),b.currentCashier.data.push(c),a.save("currentCashier",d)})},e.cleanCashRegister=function(){a["delete"]("currentCashier"),a["delete"]("ticket")},e.checkOpenShift=function(){a.load("currentCashier").then(function(a){a||d.path("/cashier")})},e.updateCashInCashier=function(b){a.load("currentCashier").then(function(c){c.insideCash=c.cash+b,a.save("currentCashier",c)})},e}]),angular.module("minimagApp").controller("CashiersCtrl",["cashier","$rootScope","$location","synchronization","cashierFactory","config","$scope","ngDialog",function(a,b,c,d,e,f,g,h){var i=this;i.cashierName=f.cashier.name,i.cash=0,i.slot=[],b.active=5,i.currentCashier=b.currentCashier?b.currentCashier:null,i.contentLoaded=!1,(i.init=function(){d.load("currentCashier").then(function(a){a?(b.currentCashier=a,i.currentCashier=b.currentCashier,i.cash=a.cash,i.insideCash=a.insideCash,i.date=a.createdAt,i.contentLoaded=!0,d.load("ticket").then(function(a){a?i.numberOfTickets=a.length:i.numberOfTickets=0})):i.currentCashier=null})})(),i.saveCashierInformations=function(){try{a.initCashier(i.cashierName,i.cash,[],function(){c.path("/")})}catch(b){console.error(b),alert("An error has occured, be sure to provide the right informations for a cashier.")}},i.closeShift=function(){j(function(b,f){return f?void alert(f):void d.load("closedCashiers").then(function(f){d.load("currentCashier").then(function(h){if(f)i=f;else{var i={};i.data=[]}if(h){i.lastUpdate=moment().format("YYYY-MM-DD HH:mm");var j=new e(h.name,h.cash);d.load("ticket").then(function(e){e?e:e=[],j.data=e,j.createdAt=h.createdAt,j.launchAnalysis(),j.isOpen=!1,j.closedAt=moment().format("DD/MM/YYYY HH:mm:ss"),a.isOpen=!1,j.cashAtClosure=b,j.differences=parseFloat(parseFloat(h.insideCash)-b),i.data.push(j),d.save("closedCashiers",i),a.cleanCashRegister(),alert("Cashier closed. Do not forget to synchronize"),g.$emit("closedCashiers_update"),c.path("/")})}})})})},i.cashInit=function(a,b){"x"===b?i.slot=[]:i.slot.push(b),i.slot.length?i.cash=_.parseInt(_.join(i.slot,""))/100:i.cash=0},i.goSetting=function(){c.path("/settings")},i["return"]=function(){c.path("/")};var j=function(a){g.dialog={},g.dialog.prompt="Please count and write the cash inside the cashier machine. (Decimal value with a '.' like: 10.00)","0.00",g.dialog.type="number",h.openConfirm({template:'<p>{{dialog.prompt}}</p><form class="prompt-dialog-form"><input class="input" type="{{dialog.type}}" ng-model="userAnswer"><button class="confirm" type="submit" ng-click="checkInput(userAnswer)">Ok</button>    </form>',plain:!0,scope:g,controller:["$scope",function(b){b.checkInput=function(c){var d=parseFloat(c);isNaN(d)?a(d,new Error("Please try again and provide the right input.")):a(d,void 0),b.closeThisDialog()}}]})};b.$on("keyListner",i.cashInit),i.displayPayment=!1}]),angular.module("minimagApp").factory("cashierFactory",function(){var a=function(a,b){this.name=a,this.cash=b,this.insideCash=b,this.cashAtClosure=0,this.data=[],this.isOpen=!1,this.numberOfSaleProducts=0,this.averageOrder=0,this.differences=0,this.createdAt="",this.closedAt="",this.hasBeenClosedSync=!1,this.hasBeenInitSync=!1,this.totalAmount=0,this.totalVAT=0,this.totalPaidBy={cash:{totalTransaction:0,amount:0},card:{totalTransaction:0,amount:0},check:{totalTransaction:0,amount:0},giftCard:{totalTransaction:0,amount:0},payPal:{totalTransaction:0,amount:0},amexCard:{totalTransaction:0,amount:0}}};return a.prototype.launchAnalysis=function(){this.averageOrder=_.sumBy(this.data,function(a){return a?a.ticketAmount:0})/this.data.length,this.data.every(function(a){console.log(a),this.totalAmount+=parseFloat(a.ticketAmount),this.totalVAT+=parseFloat(a.totalVAT),a.ticketData.forEach(function(a){this.numberOfSaleProducts+=a.cartQuantity},this),this.totalPaidBy.cash.amount+=parseFloat(a.isPaidBy.cash.amount),this.totalPaidBy.cash.totalTransaction+=a.isPaidBy.cash.value?1:0,this.totalPaidBy.card.amount+=parseFloat(a.isPaidBy.card.amount),this.totalPaidBy.card.totalTransaction+=a.isPaidBy.card.value?1:0,this.totalPaidBy.check.amount+=parseFloat(a.isPaidBy.cheque.amount),this.totalPaidBy.check.totalTransaction+=a.isPaidBy.cheque.value?1:0,this.totalPaidBy.giftCard.amount+=parseFloat(a.isPaidBy.giftCard.amount),this.totalPaidBy.giftCard.totalTransaction+=a.isPaidBy.giftCard.value?1:0,this.totalPaidBy.payPal.amount+=parseFloat(a.isPaidBy.paypal.amount),this.totalPaidBy.payPal.totalTransaction+=a.isPaidBy.paypal.value?1:0,this.totalPaidBy.amexCard.amount+=parseFloat(a.isPaidBy.card.amount),this.totalPaidBy.amexCard.totalTransaction+=a.isPaidBy.card.value?1:0},this)},a}),angular.module("minimagApp").directive("keynumber",function(){return{templateUrl:"views/template/keynumber.html",restrict:"A",scope:{restart:"="},link:function(a,b,c){a.balanceCalculator=function(b){a.$emit("keyListner",b)}}}}),angular.module("minimagApp").constant("minihubRoutes",{printer:{printCashier:"/mm/plugins/printer/cashier",printTicket:"/mm/plugins/printer/ticket",printTicket_openCashDraw:"/mm/plugins/printer/ticket/cd",openCashDraw:"/mm/plugins/printer/cd"},mail:{sendTicketMail:"/mm/plugins/mail/ticket",sendTicketCashier:"/mm/plugins/mail/cashier"}}),angular.module("minimagApp").controller("ClosedcashiersCtrl",["$rootScope","synchronization","ngDialog","$scope",function(a,b,c,d){var e=this;a.active=7,d.hideCashier=!0,(e.init=function(){b.load("closedCashiers").then(function(b){b&&(e.closedCashiers=b,a.closedCashiersLength=b.data.length)})})(),e.openModalInfo=function(a){console.log("Consulting cashiers."),d.hideCashier=!1,
d.selectedCashier=a,console.log(a)}}]),angular.module("minimagApp").service("mail",["minihubRoutes","$http","config",function(a,b,c){var d=this;return d.sendTicketTo=function(d,e,f){var g={ticket:d,receiver:e,confApi:c.mailApi};b({method:"POST",url:"http://"+c.minihub.ip+":"+c.minihub.port+a.mail.sendTicketMail,headers:{"content-type":"application/json",ip:c.printer.ip,port:c.printer.port,printer_name:"Printer Test",printer_type:c.printer.type},data:g}).then(function(a){f&&f(a,null)},function(a){f&&f(null,a),console.error(a)})},d.sendCashierTo=function(d,e,f){var g={cashier:d,receiver:e,confApi:c.mailApi};b({method:"POST",url:"http://"+c.minihub.ip+":"+c.minihub.port+a.mail.sendTicketCashier,headers:{"content-type":"application/json",ip:c.printer.ip,port:c.printer.port,printer_name:"Printer Test",printer_type:c.printer.type},data:g}).then(function(a){f&&f(a,null)},function(a){f&&f(null,a),console.error(a)})},d}]),angular.module("minimagApp").directive("cashier",["print","mail","ngDialog","config",function(a,b,c,d){return{templateUrl:"views/partials/cashier.html",restrict:"A",scope:{currentCashier:"="},link:function(e,f,g){e.printCashier=function(b,c){a.printCashier(b,function(a,b){b?alert("Cashier can not be printed."):console.log("Cashier printed.")})},e.sendCashierByMail=function(a,f){a.shopInfo=d.shopInfo,e.dialog={},e.dialog.prompt="Mail receiver: (ex: toto@gmail.com)",e.dialog.type="email",c.openConfirm({template:'<p>{{dialog.prompt}}</p><form class="prompt-dialog-form"><input class="input" type="{{dialog.type}}" ng-model="userAnswer"><button class="confirm" type="submit" ng-click="checkInput(userAnswer)">Ok</button>    </form>',plain:!0,scope:e,controller:["$scope",function(c){e.checkInput=function(d){""!=d&&/^[a-zA-Z0-9.!#$%&â€™*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(d)&&(a.mailReceiver=d,console.log("MAIL CASHIER",a),b.sendCashierTo(a,a.mailReceiver,function(a,b){b?alert("Cashier can not be sent by mail."):(console.log("Cashier sent by mail."),alert("Cashier can not be sent by mail."))})),c.closeThisDialog()}}]})},e.syncCashier=function(a){throw new Error("Not Yet Implemented")}}}}]),angular.module("minimagApp").run(["$templateCache",function(a){a.put("views/about.html",""),a.put("views/cashier-shift.html",'<div class="panel" ng-include="\'views/partials/panel-cashier.html\'"></div>'),a.put("views/closed-cashiers.html",'<nav ng-include="\'views/includes/nav.html\'"></nav> <section class="ticket" cashier current-cashier="selectedCashier" ng-hide="hideCashier"></section> <div class="panel" id="" ng-include="\'views/partials/panel-closedcashiers.html\'"></div>'),a.put("views/includes/nav.html",'<div class="navbar" ng-controller="NavCtrl as nav" ng-hide="navHiden"> <ul ng-show="nav.isMenuOpen"> <!-- First place --> <li ng-show="nav.isShiftOpen"> <a ng-class="{\'active\': (active === 0)}" ng-href="#!/"> <span class="mini minicashier-machine"> <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span><span class="path9"></span><span class="path10"></span><span class="path11"></span><span class="path12"></span><span class="path13"></span><span class="path14"></span><span class="path15"></span><span class="path16"></span><span class="path17"></span><span class="path18"></span><span class="path19"></span><span class="path20"></span><span class="path21"></span><span class="path22"></span><span class="path23"></span><span class="path24"></span><span class="path25"></span><span class="path26"></span><span class="path27"></span><span class="path28"></span><span class="path29"></span><span class="path30"></span><span class="path31"></span><span class="path32"></span><span class="path33"></span><span class="path34"></span><span class="path35"></span> </span> <span class="text">Cashier</span> </a> </li> <li ng-show="!nav.isShiftOpen"> <a ng-class="{\'active\': (active === 0)}" ng-href="#!/cashier"> <span class="mini minipadlock"> <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span> </span> <span class="text">Open</span> </a> </li> <!-- End First place --> <!-- Second place --> <li ng-show="nav.isShiftOpen"> <a ng-href="#!/archives" ng-class="{\'active\': (active === 1)}"> <span class="mini minisearch"> <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span><span class="path9"></span><span class="path10"></span><span class="path11"></span><span class="path12"></span><span class="path13"></span><span class="path14"></span><span class="path15"></span><span class="path16"></span><span class="path17"></span><span class="path18"></span><span class="path19"></span><span class="path20"></span><span class="path21"></span> </span> <span class="text">Tickets</span> </a> </li> <!-- End Second place --> <li> <a ng-href="#!/closedcashiers" ng-class="{\'active\': (active === 7)}"> <span class="mini miniarchive"> <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span><span class="path9"></span><span class="path10"></span> </span> <span class="text">Archives</span> <button class="badge badge-warning inside-nav" ng-if="nav.cashiersUnSync > 0 ">{{nav.cashiersUnSync}}</button> </a> </li> <!-- Fifth place --> <li ng-show="nav.isShiftOpen"> <a ng-href="#!/cashier" ng-class="{\'active\': (active === 5)}"> <span class="mini miniunlock"> <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span> </span> <span class="text">Close</span> </a> </li> <!-- End Fifth place --> <!-- Third place --> <li> <a ng-href="#!/settings" ng-class="{\'active\': (active === 2)}"> <span class="mini minisettings"> <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span><span class="path9"></span><span class="path10"></span><span class="path11"></span><span class="path12"></span><span class="path13"></span><span class="path14"></span> </span> <span class="text">Settings</span> </a> </li> <!-- End third place --> <!-- Fourth place --> <li> <a ng-href="#!/prestashop" ng-class="{\'active\': (active === 4)}"> <span class="mini miniwww"> <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span> </span> <span class="text">Website</span> </a> </li> <!-- End fourth place --> <!-- Sixth place --> <li ng-show="nav.isOnline"> <a ng-click="nav.displayConnectionInfo()" ng-class="{\'active\': (active === 6)}"> <span class="mini miniwifi-signal"> <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span> </span> <span class="text">Online</span> </a> </li> <li ng-show="!nav.isOnline"> <a ng-click="nav.displayConnectionInfo()" ng-class="{\'active\': (active === 6)}"> <span class="mini miniwifi"> <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span> </span> <span class="text">Offline</span> </a> </li> <!-- End sixth place --> <!-- <li><a ng-href="#!/pendings" ng-class="{\'active\': (active === 3)}"><i class="fa fa-clock-o" aria-hidden="true"></i><span>Waitings</span></a></li> --> </ul> </div>'),a.put("views/partials/actions.html",'<button class="checkout" id="checkout" ng-disabled="sales.isTicket()" ng-click="sales.validateTicket(sales)"><span>Checkout</span> <span class="price-button" ng-bind="sales.ticketAmount | currency:\'â‚¬\'">{{}}</span></button>'),a.put("views/partials/cashier.html",'<!-- start Cashier view --> <h1 class="title-h1">#{{currentCashier.name}}</h1> <p class="date-start">Du {{currentCashier.createdAt}}</p> <p class="date-end">Au {{currentCashier.closedAt}}</p> <p class="article-number">{{currentCashier.numberOfSaleProducts}} articles vendus</p> <ul class="items-list" id="items-list"> <li ng-repeat="(key,item) in currentCashier.totalPaidBy"> <article class="row flex-container"> <div class="item-title" ng-bind="key"></div> <div class="item-quantity"> <button class="badge badge-warning ng-binding ng-scope" ng-bind="item.totalTransaction"></button> </div> <div class="item-price" ng-bind="item.amount | currency:\'â‚¬\'"></div> </article> </li> </ul> <ul class="ticket-result"> <li class="tva-line flex-container" ng-class="{\'card-warning\': currentCashier.differences < 0,\'card-success\': currentCashier.differences === 0,\'card-danger\': currentCashier.differences > 0}"> <span class="item-legend">Balance</span><span class="price-result">{{currentCashier.differences | currency: \'â‚¬\'}}</span> </li> <li class="tva-line flex-container"> <span class="item-legend">Total TVA included</span><span class="price-result">{{currentCashier.totalVAT | currency:\'â‚¬\'}}</span> </li> <li class="total-line flex-container"> <span class="item-legend">Total</span><span class="price-result">{{currentCashier.totalAmount | currency:\'â‚¬\'}}</span> </li> </ul> <div class="button-actions-container"> <button class="button-print" ng-click="printCashier(currentCashier)"><i class="fa fa-print" aria-hidden="true"></i> PRINT</button> <button class="button-print" ng-click="sendCashierByMail(currentCashier)"><i class="fa fa-envelope" aria-hidden="true"></i> MAIL</button> <button class="button-sync" ng-click="syncCashier(currentCashier)"><i class="fa fa-refresh" aria-hidden="true"></i> SYNC</button> </div> <!-- End Cashier view -->'),a.put("views/partials/panel-archive.html",'<div class="tickets-options-module"> <button class="tab" ng-class="{\'active\': archives.isCurrentTicketActive}" ng-click="archives.getTickets(\'current\')">Tickets</button> <button class="tab" ng-class="{\'active\': !archives.isCurrentTicketActive}" ng-click="archives.getTickets(\'archives\')">History</button> </div> <header class="header-panel flex-container"> <div class="search-module"> <form ng-submit="archives.getItems()"> <label class="search-title" for="search">Tickets</label> <input type="search" class="search-input input" autofocus ng-model="archives.search"> <input type="submit" class="submit search invisible"> </form> </div> <div class="quantity-module"> <div class="quantity-title" ng-bind="archives.ticketsList.length"></div> <span class="quantity-legens">Tickets</span> </div> </header> <section class="panel-items-list"> <header class="header-panel-item-list flex-container panel-row-header"> <div class="actions-head delete-col"></div> <div class="ean-head" ng-bind="\'Ticket ID\'"></div> <div class="client-head" ng-bind="\'Client\'"></div> <div class="date-head" ng-bind="\'Date\'"></div> <div class="qtx-head" ng-bind="\'Articles\'"></div> <div class="total-head" ng-bind="\'Total Amount\'"></div> <div class="sync-head" ng-bind="\'Sync\'"></div> </header> <div ng-if="archives.ticketsList == undefined" class="bg-placeholder empty"> <div class="empty-screen"> <img width="75px" src="data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MTIgNTEyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjUxMnB4IiBoZWlnaHQ9IjUxMnB4Ij4KPHBhdGggc3R5bGU9ImZpbGw6IzI5MzEzMzsiIGQ9Ik00MDcuMzI1LDBIMTA0LjY3NUM4Mi44MjQsMCw2NS4xMSwxNy43MTQsNjUuMTEsMzkuNTY1djQzMi44N2MwLDIxLjg1MSwxNy43MTQsMzkuNTY1LDM5LjU2NSwzOS41NjUgIGgzMDIuNjQ5YzIxLjg1MSwwLDM5LjU2NS0xNy43MTQsMzkuNTY1LTM5LjU2NVYzOS41NjVDNDQ2Ljg5LDE3LjcxNCw0MjkuMTc2LDAsNDA3LjMyNSwweiIvPgo8cmVjdCB4PSIxMTEuODUxIiB5PSI0Ni43NDEiIHN0eWxlPSJmaWxsOiM1NkQ2NzY7IiB3aWR0aD0iMjg4LjI5OSIgaGVpZ2h0PSIxMTUuOTg4Ii8+Cjxwb2x5Z29uIHN0eWxlPSJvcGFjaXR5OjAuMTU7ZmlsbDojMzMzMzMzO2VuYWJsZS1iYWNrZ3JvdW5kOm5ldyAgICA7IiBwb2ludHM9IjQwMC4xNDksNDYuNzQxIDExMS44NTEsNDYuNzQxIDExMS44NTEsNDYuNzQxICAgMTExLjg1MSw4MS43OTcgMTExLjg1MSwxNjIuNzMgMTQ2Ljk2OCwxNjIuNzMgMTQ2Ljk2OCw4MS43OTcgNDAwLjE0OSw4MS43OTcgIi8+CjxnPgoJPHBhdGggc3R5bGU9ImZpbGw6I0NDRjdGRjsiIGQ9Ik0yMDkuNDExLDQ0Ni4zN2gxMS4yNDFjMTEuNTA5LDAsMjAuODM5LTkuMzMsMjAuODM5LTIwLjg0di0xMS4yNDEgICBjMC0xMS41MDktOS4zMjktMjAuODM5LTIwLjgzOS0yMC44MzloLTExLjI0MWMtMTEuNTA5LDAtMjAuODM5LDkuMzMtMjAuODM5LDIwLjgzOXYxMS4yNDEgICBDMTg4LjU3Miw0MzcuMDM5LDE5Ny45MDMsNDQ2LjM3LDIwOS40MTEsNDQ2LjM3eiIvPgoJPHBhdGggc3R5bGU9ImZpbGw6I0NDRjdGRjsiIGQ9Ik0xMjcuNDc2LDQ0Ni4zN2gxMS4yNDFjMTEuNTA5LDAsMjAuODM5LTkuMzMsMjAuODM5LTIwLjg0di0xMS4yNDEgICBjMC0xMS41MDktOS4zMjktMjAuODM5LTIwLjgzOS0yMC44MzloLTExLjI0MWMtMTEuNTA5LDAtMjAuODM5LDkuMzMtMjAuODM5LDIwLjgzOXYxMS4yNDEgICBDMTA2LjYzNiw0MzcuMDM5LDExNS45NjcsNDQ2LjM3LDEyNy40NzYsNDQ2LjM3eiIvPgo8L2c+CjxwYXRoIHN0eWxlPSJmaWxsOiNGRjgwOTU7IiBkPSJNNDA1LjM2NCwyMzcuODh2MTEuMjQxYzAsMTEuNTA5LTkuMzI5LDIwLjgzOS0yMC44NCwyMC44MzloLTExLjI0MSAgYy0xMS41MDksMC0yMC44MzktOS4zMjktMjAuODM5LTIwLjgzOVYyMzcuODhjMC0xMS41MDksOS4zMjktMjAuODM5LDIwLjgzOS0yMC44MzloMTEuMjQxICBDMzk2LjAzMywyMTcuMDQxLDQwNS4zNjQsMjI2LjM3LDQwNS4zNjQsMjM3Ljg4eiIvPgo8Zz4KCTxwYXRoIHN0eWxlPSJmaWxsOiNDQ0Y3RkY7IiBkPSJNMjkxLjM0NywzNTguMTY1aDExLjI0MWMxMS41MDksMCwyMC44NC05LjMzLDIwLjg0LTIwLjgzOXYtMTEuMjQxICAgYzAtMTEuNTA5LTkuMzMtMjAuODM5LTIwLjgzOS0yMC44MzloLTExLjI0MWMtMTEuNTA5LDAtMjAuODM5LDkuMzMtMjAuODM5LDIwLjgzOXYxMS4yNDEgICBDMjcwLjUwOCwzNDguODM1LDI3OS44MzksMzU4LjE2NSwyOTEuMzQ3LDM1OC4xNjV6Ii8+Cgk8cGF0aCBzdHlsZT0iZmlsbDojQ0NGN0ZGOyIgZD0iTTIwOS40MTEsMzU4LjE2NWgxMS4yNDFjMTEuNTA5LDAsMjAuODM5LTkuMzMsMjAuODM5LTIwLjgzOXYtMTEuMjQxICAgYzAtMTEuNTA5LTkuMzI5LTIwLjgzOS0yMC44MzktMjAuODM5aC0xMS4yNDFjLTExLjUwOSwwLTIwLjgzOSw5LjMzLTIwLjgzOSwyMC44Mzl2MTEuMjQxICAgQzE4OC41NzIsMzQ4LjgzNSwxOTcuOTAzLDM1OC4xNjUsMjA5LjQxMSwzNTguMTY1eiIvPgoJPHBhdGggc3R5bGU9ImZpbGw6I0NDRjdGRjsiIGQ9Ik0xMjcuNDc2LDM1OC4xNjVoMTEuMjQxYzExLjUwOSwwLDIwLjgzOS05LjMzLDIwLjgzOS0yMC44Mzl2LTExLjI0MSAgIGMwLTExLjUwOS05LjMyOS0yMC44MzktMjAuODM5LTIwLjgzOWgtMTEuMjQxYy0xMS41MDksMC0yMC44MzksOS4zMy0yMC44MzksMjAuODM5djExLjI0MSAgIEMxMDYuNjM2LDM0OC44MzUsMTE1Ljk2NywzNTguMTY1LDEyNy40NzYsMzU4LjE2NXoiLz4KCTxwYXRoIHN0eWxlPSJmaWxsOiNDQ0Y3RkY7IiBkPSJNMjkxLjM0NywyNjkuOTZoMTEuMjQxYzExLjUwOSwwLDIwLjg0LTkuMzI5LDIwLjg0LTIwLjgzOXYtMTEuMjQxICAgYzAtMTEuNTA5LTkuMzMtMjAuODM5LTIwLjgzOS0yMC44MzloLTExLjI0MWMtMTEuNTA5LDAtMjAuODM5LDkuMzI5LTIwLjgzOSwyMC44Mzl2MTEuMjQxICAgQzI3MC41MDgsMjYwLjYzLDI3OS44MzksMjY5Ljk2LDI5MS4zNDcsMjY5Ljk2eiIvPgoJPHBhdGggc3R5bGU9ImZpbGw6I0NDRjdGRjsiIGQ9Ik0yMDkuNDExLDI2OS45NmgxMS4yNDFjMTEuNTA5LDAsMjAuODM5LTkuMzI5LDIwLjgzOS0yMC44Mzl2LTExLjI0MSAgIGMwLTExLjUwOS05LjMyOS0yMC44MzktMjAuODM5LTIwLjgzOWgtMTEuMjQxYy0xMS41MDksMC0yMC44MzksOS4zMjktMjAuODM5LDIwLjgzOXYxMS4yNDEgICBDMTg4LjU3MiwyNjAuNjMsMTk3LjkwMywyNjkuOTYsMjA5LjQxMSwyNjkuOTZ6Ii8+Cgk8cGF0aCBzdHlsZT0iZmlsbDojQ0NGN0ZGOyIgZD0iTTEyNy40NzYsMjY5Ljk2aDExLjI0MWMxMS41MDksMCwyMC44MzktOS4zMjksMjAuODM5LTIwLjgzOXYtMTEuMjQxICAgYzAtMTEuNTA5LTkuMzI5LTIwLjgzOS0yMC44MzktMjAuODM5aC0xMS4yNDFjLTExLjUwOSwwLTIwLjgzOSw5LjMyOS0yMC44MzksMjAuODM5djExLjI0MSAgIEMxMDYuNjM2LDI2MC42MywxMTUuOTY3LDI2OS45NiwxMjcuNDc2LDI2OS45NnoiLz4KCTxwYXRoIHN0eWxlPSJmaWxsOiNDQ0Y3RkY7IiBkPSJNMjkxLjM0Nyw0NDYuMzdoMTEuMjQxYzExLjUwOSwwLDIwLjg0LTkuMzMsMjAuODQtMjAuODR2LTExLjI0MSAgIGMwLTExLjUwOS05LjMzLTIwLjgzOS0yMC44MzktMjAuODM5aC0xMS4yNDFjLTExLjUwOSwwLTIwLjgzOSw5LjMzLTIwLjgzOSwyMC44Mzl2MTEuMjQxICAgQzI3MC41MDgsNDM3LjAzOSwyNzkuODM5LDQ0Ni4zNywyOTEuMzQ3LDQ0Ni4zN3oiLz4KPC9nPgo8cGF0aCBzdHlsZT0iZmlsbDojNTZENjc2OyIgZD0iTTQwNS4zNjQsNDI1LjUzYzAsMTEuNTA5LTkuMzI5LDIwLjg0LTIwLjg0LDIwLjg0aC0xMS4yNDFjLTExLjUwOSwwLTIwLjgzOS05LjMzLTIwLjgzOS0yMC44MzkgIHYtOTkuNDQ2YzAtMTEuNTA5LDkuMzI5LTIwLjgzOSwyMC44MzktMjAuODM5aDExLjI0MWMxMS41MDksMCwyMC44MzksOS4zMywyMC44MzksMjAuODM5TDQwNS4zNjQsNDI1LjUzTDQwNS4zNjQsNDI1LjUzeiIvPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K"> <div class="no-empty-message" ng-bind="\'Empty ticket list in current cashier.\'"></div> <button class="btn btn-success"><a class="inherit" ng-href="/" ng-bind="\'Start selling\'"></a></button> </div> </div> <ul> <li class="panel-row" ng-repeat="item in archives.ticketsList | filter:archives.search | orderBy:\'-date\' track by $index" ng-class="{\'disabled\': (item.status == \'CANCELED\')}" ng-click="archives.openTicket(item.ticketId)"> <div class="actions-column delete-col"><button ng-hide="item.hasBeenSynchronized" class="action btn-delete" ng-if="(item.status !== \'CANCELED\') && archives.isCurrentTicketActive" ng-click="archives.canceledItem(item.ticketId)"><i class="fa fa-remove" aria-hidden="true"></i></button></div> <div class="ean-column" ng-bind="item.ticketId"></div> <div class="client-column" ng-bind="item.client.name"></div> <div class="date-column" ng-bind="item.date | amDateFormat:\'dddd Do MMMM YYYY, HH:mm\'"></div> <div class="qtx-column" ng-bind="item.ticketData.length"></div> <div class="total-column" ng-bind="item.ticketAmount | currency : \'â‚¬\'"></div> <div class="sync-column"> <button class="button-sync" ng-click="syncTicket(item)" ng-hide="item.hasBeenSynchronized"><i class="fa fa-refresh" aria-hidden="true"></i> SYNC</button> </div> </li> </ul> </section>'),a.put("views/partials/panel-cashier.html",'<!-- open --> <section class="shift shift-open" ng-if="!cashier.currentCashier && !cashier.contentLoaded"> <form class="settings"> <div class="balance-line balance-cash-fund"> <span class="balance-title" ng-bind="\'Cash fund opening\'"></span> <span class="balance-price">{{cashier.cash | currency:\'â‚¬\'}}</span> </div> <div class="calculator-keyboard" keynumber></div> <button ng-click="cashier.saveCashierInformations()" class="save btn-add" ng-bind="\'Open cashier\'"></button> </form> </section> <!-- close --> <section class="shift shift-close" ng-if="cashier.currentCashier"> <form class="settings"> <h1 class="setting-title" ng-bind="cashier.cashierName"></h1> <div class="balance-field"> <div class="balance-line balance-tickets"> <span class="balance-title" ng-bind="\'Tickets number\'"></span> <span class="balance-price">{{cashier.numberOfTickets}}</span> </div> <div class="balance-line balance-cash"> <span class="balance-title" ng-bind="\'Cash at open\'"></span> <span class="balance-price">{{cashier.cash | currency:\'â‚¬\'}}</span> </div> <div class="balance-line balance-cash"> <span class="balance-title" ng-bind="\'Inside Cash in cashier\'"></span> <span class="balance-price">{{cashier.insideCash | currency:\'â‚¬\'}}</span> </div> <div class="balance-line balance-date"> <span class="balance-title" ng-bind="\'Open date\'"></span> <span class="balance-price">{{cashier.date}}</span> </div> </div> <button ng-click="cashier.closeShift()" class="save btn-delete" ng-bind="\'Close cashier\'"></button> </form> <button class="return" ng-click="cashier.return()" id="return-view"><i class="fa fa-chevron-left" aria-hidden="true"></i></button> </section> <button class="setting-button" ng-click="cashier.goSetting()"><i class="fa fa-cog" aria-hidden="true"></i></button>'),a.put("views/partials/panel-closedcashiers.html",'<header class="header-panel flex-container"> <div class="search-module"> <form ng-submit="clsCashiers.getItems()"> <label class="search-title" for="search">Cashiers</label> <input type="search" class="search-input input" autofocus ng-model="clsCashiers.search"> <input type="submit" class="submit search invisible"> </form> </div> <div class="quantity-module"> <div class="quantity-title" ng-bind="clsCashiers.closedCashiers.data.length"></div> <span class="quantity-legens">Cashiers</span> </div> </header> <section class="panel-items-list"> <header class="header-panel-item-list flex-container panel-row-header"> <div class="head">Cashier ID</div> <div class="date-head">Open Date</div> <div class="date-head">Close Date</div> <div class="qtx-head">Ticket num.</div> <div class="total-head">Total Amount</div> <div class="total-hea">Total VAT</div> <div class="total-hea">Differences</div> <div class="actions-head">Sync</div> </header> <div ng-if="clsCashiers.closedCashiers.data == undefined" class="bg-placeholder empty"> <div class="empty-screen"> <img width="75px" src="data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAzNDcuNDc5IDM0Ny40NzkiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM0Ny40NzkgMzQ3LjQ3OTsiIHhtbDpzcGFjZT0icHJlc2VydmUiIHdpZHRoPSI1MTJweCIgaGVpZ2h0PSI1MTJweCI+CjxnPgoJPHBhdGggc3R5bGU9ImZpbGw6I0UwQjAzQjsiIGQ9Ik0yOTIuMjUxLDc5Ljc2NkgxMDMuNjQ0di04LjU0NGMwLTUuOTc0LTQuODg4LTEwLjg2Mi0xMC44NjItMTAuODYySDMwLjQxNCAgIGMtNS45NzUsMC0xMC44NjIsNC44ODgtMTAuODYyLDEwLjg2MnY4LjU0NGgtMy4yNThDNy4zMzIsNzkuNzY2LDAsODcuMDk4LDAsOTYuMDU5djE3NC43NjZjMCw4Ljk2MSw3LjMzMiwxNi4yOTMsMTYuMjkzLDE2LjI5MyAgIGgyNzUuOTU4YzguOTYxLDAsMTYuMjkzLTcuMzMyLDE2LjI5My0xNi4yOTNWOTYuMDU5QzMwOC41NDUsODcuMDk4LDMwMS4yMTMsNzkuNzY2LDI5Mi4yNTEsNzkuNzY2eiIvPgoJPHJlY3QgeD0iMjMuMjQzIiB5PSI5NS4zODUiIHN0eWxlPSJmaWxsOiNGRkZGRkY7IiB3aWR0aD0iMjYyLjA1OSIgaGVpZ2h0PSIxNzYuMTEzIi8+Cgk8cGF0aCBzdHlsZT0iZmlsbDojRkZDODQzOyIgZD0iTTMxMi40MjYsMjcxLjI5M2MtMi4xMzUsOC43MDQtMTEuMjEzLDE1LjgyNS0yMC4xNzUsMTUuODI1SDE2LjI5MyAgIGMtOC45NjEsMC0xNC41NDctNy4xMjEtMTIuNDEyLTE1LjgyNWwzNC41OTgtMTQxLjA1YzIuMTM1LTguNzA0LDExLjIxMy0xNS44MjUsMjAuMTc1LTE1LjgyNWgyNzUuOTU4ICAgYzguOTYxLDAsMTQuNTQ3LDcuMTIxLDEyLjQxMiwxNS44MjVMMzEyLjQyNiwyNzEuMjkzeiIvPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+Cjwvc3ZnPgo="> <div class="no-empty-message" ng-bind="\'Empty cashier list.\'"></div> <button class="btn btn-success"><a class="inherit" ng-href="#!/cashier" ng-bind="\'Close the current cashier\'"></a></button> </div> </div> <ul> <li class="panel-row" ng-repeat="item in clsCashiers.closedCashiers.data |  filter:clsCashiers.search track by $index" ng-click="clsCashiers.openModalInfo(item)"> <div class="flex-center cashier-column-head" ng-bind="item.name"></div> <div class="client-column flex-center" ng-bind="item.createdAt"></div> <div class="date-column flex-center" ng-bind="item.closedAt"></div> <div class="qtx-column flex-center" ng-bind="item.data.length"></div> <div class="total-column flex-center" ng-bind="item.totalAmount | currency : \'â‚¬\'"></div> <div class="actions-column flex-center" ng-bind="item.totalVAT | currency : \'â‚¬\'"></div> <div class="actions-column flex-center" ng-bind="item.differences | currency : \'â‚¬\'"></div> <div class="actions-column"><button class="action btn-sync"><i class="fa fa-refresh" aria-hidden="true"></i></button></div> </li> </ul> </section>'),a.put("views/partials/panel-iframe.html",'<iframe ng-src="{{pr.baseurl}}" width="100%" height="100%"></iframe>'),a.put("views/partials/panel-sale.html",'<header class="header-panel flex-container"> <div class="search-module"> <form ng-submit="sales.flashItems(sales.items, sales.search)"> <label class="search-title" for="search">Items</label> <input type="search" class="search-input input" focus-on="yes" autofocus ng-model="sales.search"> <input type="submit" class="submit search invisible"> </form> </div> <div class="toggle-list-grid"> <i class="fa fa-list toggle-el" ng-if="sales.isGrid" ng-click="sales.toggleGrid()"></i> <i class="fa fa-table toggle-el" ng-if="!sales.isGrid" ng-click="sales.toggleGrid()"></i> </div> <div class="quantity-module"> <div class="quantity-title" ng-bind="sales.items.length"></div> <span class="quantity-legens">Items</span> </div> </header> <section class="panel-items-list" ng-class="{\'grid\': sales.isGrid, \'line\': !sales.isGrid}"> <ul> <li class="panel-row" ng-repeat="item in sales.items | filter:sales.search track by $index" ng-click="sales.getItems(item)" ng-style="{\'background-image\': \'url(\' + item.defaultImage + \')\'}"> <div class="name-column" ng-bind="item.name[0].value || item.name.language"></div> <div class="ean-column" ng-bind="item.ean13 || item.upc || item.reference"></div> <div class="price-column align-right" ng-bind="item.priceTTC | currency : \'â‚¬\'"></div> </li> </ul> </section>'),a.put("views/partials/panel-setting.html",'<!-- Start panel --> <header class="header-panel flex-container"> </header> <section class="panel-items-list"> <select ng-model="set.configIndicator" ng-change="set.reloadSettings(set.configIndicator)"> <option value="OXYNUM">OXYNUM</option> <option value="CLIENT">CLIENT</option> </select> <form ng-submit="saveSetting()" class="settings"> <h1 class="setting-title"> Your Shop </h1> <br> <label> <span> Name </span> <input class="input" type="text" ng-model="set.config.shopInfo.name"> </label> <label> <span> Address </span> <input class="input" type="text" ng-model="set.config.shopInfo.address"> </label> <label> <span> Postal code </span> <input class="input" type="text" ng-model="set.config.shopInfo.postalCode"> </label> <label> <span> City </span> <input class="input" type="text" ng-model="set.config.shopInfo.city"> </label> <label> <span> Country </span> <input class="input" type="text" ng-model="set.config.shopInfo.country"> </label> <label> <span> Phone </span> <input class="input" type="text" ng-model="set.config.shopInfo.tel"> </label> <h1 class="setting-title"> Website </h1> <br> <label> <span> Website URL </span> <input class="input" type="url" ng-model="set.config.shopInfo.websiteUrl"> </label> <label> <span> Secret key </span> <input class="input" type="password" ng-model="set.config.username"> </label> <h1 class="setting-title"> Ticket Info. </h1> <br> <label> <span> Message - PROMOTION </span> <input class="input" type="text" ng-model="set.config.messageOptions.promo"> </label> <label> <span> Message - Thanks </span> <input class="input" type="text" ng-model="set.config.messageOptions.thanks"> </label> <label> <span> Message - INFORMATIONS </span> <input class="input" type="text" ng-model="set.config.messageOptions.info"> </label> <hr> <h1 class="setting-title"> Printer </h1> <br> <label> <span> Printer type </span> <input class="tgl tgl-flat" id="cb4" type="checkbox"> <label class="tgl-btn" for="cb4"></label> </label> <label> <span> Ip address </span> <input class="input btn" type="text" ng-model="set.config.printer.ip"> </label> <label> <span> Port </span> <input class="input btn" type="text" ng-model="set.config.printer.port"> </label> <h1 class="setting-title"> Minihub </h1> <br> <label> <span> Ip address </span> <input class="input btn" type="text" ng-model="set.config.minihub.ip"> </label> <label> <span> Port </span> <input class="input btn" type="text" ng-model="set.config.minihub.port"> </label> <hr> <br> <br> <br> <label> <span> Refresh catalogue </span> <button ng-click="set.refreshProduct();" class="btn">Launch the rocket !</button> </label> <button class="save btn-add" ng-click="set.saveConfig()"> Save </button> </form> </section>'),a.put("views/partials/payment.html",'<div class="payment-page"> <div class="balance-field"> <div class="balance-line balance-left" ng-if="sales.due <= 0"> <span class="balance-title" ng-bind="\'Currency\'"></span> <span class="balance-price">{{sales.due * -1 | currency:\'â‚¬\'}}</span> </div> <div class="balance-line balance-given"> <span class="balance-title" ng-bind="\'Given\'"></span> <span class="balance-price">{{sales.moneyGiven | currency:\'â‚¬\'}}</span> </div> <div class="balance-line balance-due" ng-if="sales.due > 0"> <span class="balance-title" ng-bind="\'Due\'"></span> <span class="balance-price">{{sales.due | currency:\'â‚¬\'}}</span> </div> </div> <div class="payment-field"> <div class="calculator-keyboard" keynumber></div> <div class="payment-mode"> <button class="item card" ng-click="sales.sum(sales.moneyGiven, \'cb\')"> <i class="fa fa-credit-card-alt" aria-hidden="true"></i> <span>Credit card</span> <span>{{sales.card.amount | currency :\'â‚¬\'}}</span> </button> <button class="item card" ng-click="sales.sum(sales.moneyGiven, \'esp\')"> <i class="fa fa-money" aria-hidden="true"></i> <span>LiquiditÃ©</span> <span>{{sales.cash.amount | currency :\'â‚¬\'}}</span> </button> <button class="item card" ng-click="sales.sum(sales.moneyGiven, \'gift\')"> <i class="fa fa-cc-diners-club" aria-hidden="true"></i> <span>Gift/Meal Card</span> <span>{{sales.giftCard.amount | currency :\'â‚¬\'}}</span> </button> <button class="item card" ng-click="sales.sum(sales.moneyGiven, \'pp\')"> <i class="fa fa-cc-paypal" aria-hidden="true"></i> <span>Paypal</span> <span>{{sales.others.amount | currency :\'â‚¬\'}}</span> </button> <button class="item card" ng-click="sales.sum(sales.moneyGiven, \'cb\')"> <i class="fa fa-cc-amex" aria-hidden="true"></i> <span>Amex</span> <span>{{sales.card.amount | currency :\'â‚¬\'}}</span> </button> <button class="item card" ng-click="sales.sum(sales.moneyGiven, \'chq\')"> <i class="fa fa-cc" aria-hidden="true"></i> <span>Check</span> <span>{{sales.cheque.amount | currency :\'â‚¬\'}}</span> </button> </div> </div> <div class="ticketprint-field"> <button class="ticket-choice" ng-class="{\'active\': sales.clientOptions.mail}" ng-click="sales.updateClientOptions(\'mail\')"> <i class="fa fa-envelope-o" aria-hidden="true"></i> </button> <button class="ticket-choice" ng-class="{\'active\': sales.clientOptions.print}" ng-click="sales.updateClientOptions(\'print\')"> <i class="fa fa-print" aria-hidden="true"></i> </button> </div> <div class="ticketprint-field" ng-show="sales.clientOptions.mail"> <input type="email" placeholder="Enter email" class="mail-input" ng-model="sales.inputMail"> </div> </div>'),a.put("views/partials/products-id.html",'<div class="edit-product" ng-show="main.productView"> <div class="edit-card"> <h1 class="title"> <span class="label-title" ng-bind="main.article.name"></span> <span class="nbr-item" ng-bind="\'\'"></span> <button class="close" ng-click="main.productView = false"><span class="lnr lnr-cross-circle"></span></button> </h1> <hr> <!-- <fieldset>\n            <label class="product-status">\n                <label class="switch"><input type="checkbox" ng-model="main.article.status" checked><i></i></label> <span class="info-status" ng-show="main.article.status">Active</span><span class="info-status" ng-hide="main.article.status">Inactive</span>\n            </label>\n        </fieldset> --> <fieldset> <div class="picture" ng-style="{\'background-image\': \'url(\'+ main.article.images[0].src +\')\'}"></div> <div class="flex-label"> <div ng-bind="main.article.name.language"></div> <div ng-bind="main.article.stock"></div> </div> </fieldset> <fieldset> <div class="flex-container-column"> <div class="flex-label-inline"> <div ng-bind="main.article.regular_price | currency : \'â‚¬\'"></div> <div ng-bind="main.article.price | currency : \'â‚¬\'"></div> </div> <div class="flex-label-inline"> <div ng-bind="main.article.sku"></div> <div ng-bind="main.article.categories[0].name"></div> </div> </div> </fieldset> <fieldset> <span class="label" ng-bind="\'Description\'"></span> <div class="description label-left" ng-bind-html="main.article.description"></div> </fieldset> <fieldset class="bottom clearfix"> <hr> <button class="btn delete left"><span ng-bind="\'Setting\'"></span></button> <button class="btn save right"><span ng-bind="\'Add to cart\'"></span></button> <button class="btn cancel right" ng-click="main.productView = false"><span ng-bind="\'Cancel\'"></span></button> </fieldset> </div> <div class="overlay"></div> </div>'),
a.put("views/partials/ticket.html",'<!-- start ticket view --> <i class="push-left fa fa-chevron-left" aria-hidden="true" ng-click="hideTicket()" ng-if="!enableActions"></i> <h1 class="title-h1">{{config.shopInfo.name}}</h1> <span class="print center block">{{config.shopInfo.address}}</span> <span class="print center block">{{config.shopInfo.postalCode}} {{config.shopInfo.city}} {{config.shopInfo.country}}</span> <span class="print center block">{{config.shopInfo.tel}}</span> <h1 class="title-h1" contenteditable="{{enableActions}}">Client #{{currentTicket.client.id}}</h1> <p class="article-number">{{currentTicket.ticketData.length}} articles</p> <ul class="items-list" id="items-list"> <li ng-repeat="item in currentTicket.ticketData | orderBy:predicate track by $index"> <article class="row flex-container"> <div class="delete" ng-click="removeAllItemLine(item.reference);" ng-if="enableActions"> <i class="fa fa-times" aria-hidden="true"></i> </div> <div class="article-validate" ng-click="openItemInfo(item);" ng-if="!enableActions"> <i class="fa fa-tag" aria-hidden="true"></i> </div> <div class="item-title" ng-bind="item.name[0].value || item.name.language"></div> <div class="item-quantity" ng-if="enableActions"> <button class="quantity-button-less" ng-click="removeItem(item)" ng-disabled="item.cartQuantity <= 1">-</button> <button class="item-quantity-amount" ng-bind="item.cartQuantity"></button> <button class="quantity-button-more" ng-click="addItem(item)">+</button> </div> <div class="item-price" ng-bind="item.priceTTC * item.cartQuantity | currency:\'â‚¬\'" ng-click="isDiscountActive=!isDiscountActive"></div> </article> <div class="discount-module blockly" ng-class="{\'active\': isDiscountActive}"> <input type="text" class="input"> <fieldset class="flex"> <button class="btn btn-success" ng-bind="\'Percentage\'"></button> <button class="btn btn-success" ng-bind="\'Euros\'"></button> </fieldset> </div> <div class="blockly-overlay" ng-class="{\'active\': isDiscountActive}" ng-click="isDiscountActive=!isDiscountActive"></div> </li> </ul> <ul class="ticket-result"> <li class="tva-line flex-container" ng-repeat="item in currentTicket.orderingListVAT"> <span class="item-legend" ng-bind="\'VAT \' + item[0].rate"></span><span class="price-result">{{item.total | currency:\'â‚¬\'}}</span> </li> </ul> <ul class="ticket-result"> <li class="tva-line flex-container"> <span class="item-legend">Total TVA included</span><span class="price-result">{{currentTicket.totalVAT | currency:\'â‚¬\'}}</span> </li> <li class="total-line flex-container"> <span class="item-legend">Total</span><span class="price-result">{{currentTicket.ticketAmount | currency:\'â‚¬\'}}</span> </li> </ul> <div ng-if="enableActions" class="button-actions-container"> <button type="" ng-click="sendValidateTicket()" class="button-checkout"><i class="fa fa-check" aria-hidden="true"></i> CHECKOUT</button> </div> <div ng-if="!enableActions && currentTicket.status != \'CANCELED\'" class="button-actions-container"> <button class="button-mail" ng-click="mailTicket(currentTicket)"><i class="fa fa-envelope" aria-hidden="true"></i> MAIL</button> <br> <button class="button-print" ng-click="printTicket(currentTicket)"><i class="fa fa-print" aria-hidden="true"></i> PRINT</button> <br> <button class="button-sync" ng-click="syncTicket(currentTicket)" ng-disabled="currentTicket.hasBeenSynchronized"><i class="fa fa-refresh" aria-hidden="true"></i> SYNC</button> </div> <span class="print center block">{{config.messageOptions.promo}}</span> <span class="print center block">{{config.messageOptions.info}}</span> <span class="print center block">{{config.messageOptions.thanks}}</span> <span class="print center block">{{config.shopInfo.websiteUrl}}</span> <!-- End ticket view -->'),a.put("views/pendings.html","<p>This is the pendings view.</p>"),a.put("views/prestashop.html",'<nav ng-include="\'views/includes/nav.html\'"></nav> <div class="panel" id="ticket-view" ng-include="\'views/partials/panel-iframe.html\'"></div>'),a.put("views/products.html",'<div class="product-page clearfix"> <h1 class="title"> <span class="label-title" ng-bind="\'Products\'"></span> <span class="nbr-item" ng-bind="main.articles.length + \' products in total\'"></span> </h1> <article class="card product product-1" ng-click="main.displayProduct(item.id)" ng-repeat="item in main.articles"> <div class="picture" ng-style="{\'background-image\': \'url(\'+ item.images[0].src +\')\'}"></div> <div class="description"> <span class="name-label" ng-bind="item.name"></span> <span class="price-label" ng-bind="item.price | currency : \'â‚¬\'"></span> </div> </article> <!-- <article class="card new-product-card">\n        <span class="lnr lnr-plus-circle"></span>\n        <span class="card-label" ng-bind="\'Create a new product\'"></span>\n    </article> --> </div> <ng-include src="\'views/partials/products-id.html\'"></ng-include>'),a.put("views/sales.html",'<nav ng-include="\'views/includes/nav.html\'" ng-hide="sales.displayPayment"></nav> <section class="ticket" ticket current-ticket="sales.ticket" ng-hide="sales.isTicket() || sales.displayPayment" enable-actions="true" printable="sales.printable"></section> <div class="panel" id="ticket-view" ng-include="\'views/partials/panel-sale.html\'" ng-hide="sales.displayPayment || sales.printHide"></div> <div class="panel" id="payment-view" ng-include="\'views/partials/payment.html\'" ng-show="sales.displayPayment"></div> <button class="return" ng-click="sales.return()" id="return-view" ng-show="sales.displayPayment"><i class="fa fa-chevron-left" aria-hidden="true"></i></button> <div class="buttons-actions" ng-include="\'views/partials/actions.html\'" ng-hide="sales.displayPayment"></div>'),a.put("views/settings.html",'<nav ng-include="\'views/includes/nav.html\'"></nav> <div class="panel" id="ticket-view" ng-include="\'views/partials/panel-setting.html\'"></div>'),a.put("views/template/keynumber.html","<table> <tr> <td ng-click=\"balanceCalculator('7')\">7</td> <td ng-click=\"balanceCalculator('8')\">8</td> <td ng-click=\"balanceCalculator('9')\">9</td> </tr> <tr> <td ng-click=\"balanceCalculator('4')\">4</td> <td ng-click=\"balanceCalculator('5')\">5</td> <td ng-click=\"balanceCalculator('6')\">6</td> </tr> <tr> <td ng-click=\"balanceCalculator('1')\">1</td> <td ng-click=\"balanceCalculator('2')\">2</td> <td ng-click=\"balanceCalculator('3')\">3</td> </tr> <tr> <td ng-click=\"balanceCalculator('0')\">0</td> <td ng-click=\"balanceCalculator('00')\">.00</td> <td ng-click=\"balanceCalculator('x')\">x</td> </tr> </table>"),a.put("views/tickets-archives.html",'<nav ng-include="\'views/includes/nav.html\'"></nav> <section class="ticket" ticket current-ticket="archives.currentTicket" enable-actions="false" hide-indicator="archives.hideTicket" ng-hide="archives.hideTicket" enable-actions="true" printable="archives.printable"></section> <div class="panel" id="ticket-view" ng-include="\'views/partials/panel-archive.html\'"></div>')}]);